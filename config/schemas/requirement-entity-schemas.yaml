# 需求实体Schema配置文件
# 版本: 1.0
# 最后更新: 2024-01-15
# 描述: 为需求脚手架生成器提供实体结构定义

version: "1.0"
last_updated: "2024-01-15"
compatible_versions: ["1.0"]
description: "Requirements entity schemas for scaffold generator"

# 通用元数据模板
metadata_template: &metadata
  status: 'draft'
  created_date: null
  last_modified: null
  created_by: ''
  last_modified_by: ''
  version: '1.0'

# 基础需求实体映射
entity_mappings:
  # User Stories - 用户故事
  US:
    yaml_key: 'user_stories'
    description: 'User Stories - 用户故事'
    template:
      id: ''
      summary: ''
      description: []
      as_a: []
      i_want_to: []
      so_that: []
      acceptance_criteria: []
      derived_fr: []
      metadata: *metadata

  # Use Cases - 用例
  UC:
    yaml_key: 'use_cases'
    description: 'Use Cases - 用例'
    template:
      id: ''
      summary: ''
      description: []
      actor: []
      preconditions: []
      postconditions: []
      main_success_scenario: []
      extensions: []
      derived_fr: []
      metadata: *metadata

  # Functional Requirements - 功能需求
  FR:
    yaml_key: 'functional_requirements'
    description: 'Functional Requirements - 功能需求'
    template:
      id: ''
      summary: ''
      description: []
      priority: null  # enum: critical/high/medium/low
      source_requirements: []
      acceptance_criteria: []
      metadata: *metadata

  # Non-Functional Requirements - 非功能需求
  NFR:
    yaml_key: 'non_functional_requirements'
    description: 'Non-Functional Requirements - 非功能需求'
    template:
      id: ''
      summary: ''
      category: null  # enum: performance/security/reliability/maintainability/portability/compatibility/usability/scalability/availability/compliance
      description: []
      target_measure:
        - metric: ''
          target_value: null
      priority: null  # enum: critical/high/medium/low
      source_requirements: []
      metadata: *metadata

  # Interface Requirements - 接口需求
  IFR:
    yaml_key: 'interface_requirements'
    description: 'Interface Requirements - 接口需求'
    template:
      id: ''
      summary: ''
      description: []
      interface_type: null  # enum: api/ui/database/file/other
      input_data: []
      output_data: []
      core_validation_rules: []
      source_requirements: []
      metadata: *metadata

  # Data Requirements - 数据需求
  DAR:
    yaml_key: 'data_requirements'
    description: 'Data Requirements - 数据需求'
    template:
      id: ''
      summary: ''
      description: []
      data_entity: []
      core_attributes: []
      core_validation_rules: []
      source_requirements: []
      metadata: *metadata

  # Risk Analysis - 风险分析
  RISK:
    yaml_key: 'risk_analysis'
    description: 'Risk Analysis - 风险分析'
    template:
      id: ''
      summary: ''
      category: null  # enum: technical/business/operational/external/resource/schedule/financial/compliance
      phase: null  # enum: requirements/design/implementation/testing/deployment/maintenance
      description: []
      probability: null  # enum: high/medium/low
      impact: null  # enum: critical/high/medium/low
      risk_score: null  # enum: critical/high/medium/low
      affected_requirements:
        business_objectives: []
        business_requirements: []
        use_cases: []
        user_stories: []
        functional_requirements: []
        non_functional_requirements: []
        dependencies: []
      triggers: []
      mitigation_strategy:
        approach: null  # enum: preventive/detective/corrective
        actions: []
        resources_required: ''
        cost_estimate: ''
        timeline: ''
        success_criteria: []
      contingency_plan:
        trigger_condition: ''
        actions: []
        resources_required: ''
        recovery_time: ''
      residual_risk: null  # enum: critical/high/medium/low
      risk_owner: ''
      status: null  # enum: identified/assessed/mitigated/monitoring/closed/materialized
      metadata: *metadata

  # Test Cases - 测试用例
  TC:
    yaml_key: 'test_cases'
    description: 'Test Cases - 测试用例'
    template:
      id: ''
      summary: ''
      test_level: ''  # Reference to TEST-LEVEL-XXX
      test_type: ''   # Reference to TEST-TYPE-XXX
      tested_requirements:
        business_objectives: []
        business_requirements: []
        business_rules: []
        use_cases: []
        user_stories: []
        functional_requirements: []
        non_functional_requirements: []
        interface_requirements: []
        data_requirements: []
      priority: null  # enum: critical/high/medium/low
      status: null    # enum: planned/designed/implemented/executed/passed/failed/blocked
      metadata: *metadata

# ADC (Assumptions, Dependencies, Constraints) 复合实体映射
adc_mappings:
  # Assumptions - 假设条件
  ASSU:
    yaml_key: 'assumptions'
    description: 'Assumptions - 假设条件'
    template:
      id: ''
      summary: ''
      assumptions: []
      risk_if_false: []
      impacted_requirements: []
      validation_method: []
      owner: ''
      metadata: *metadata

  # Dependencies - 依赖关系
  DEPEN:
    yaml_key: 'dependencies'
    description: 'Dependencies - 依赖关系'
    template:
      id: ''
      summary: ''
      dependencies: []
      impacted_requirements: []
      risk_level: null  # enum: critical/high/medium/low
      mitigation_strategy: []
      owner: ''
      metadata: *metadata

  # Constraints - 约束条件
  CONST:
    yaml_key: 'constraints'
    description: 'Constraints - 约束条件'
    template:
      id: ''
      summary: ''
      constraints: []
      justification: []
      impacted_requirements: []
      mitigation_strategy: []
      owner: ''
      metadata: *metadata

# TEST (Test Levels, Test Types, Test Environments) 复合实体映射
test_mappings:
  # Test Levels - 测试层级
  LEVEL:
    yaml_key: 'test_levels'
    description: 'Test Levels - 测试层级'
    template:
      id: ''
      summary: ''
      objective: ''
      scope: []
      test_basis: []
      test_items: []
      responsibilities: ''
      test_techniques: []
      tools: []
      coverage_target: ''
      entry_criteria: []
      exit_criteria: []
      deliverables: []
      metadata: *metadata

  # Test Types - 测试类型
  TYPE:
    yaml_key: 'test_types'
    description: 'Test Types - 测试类型'
    template:
      id: ''
      summary: ''
      objective: ''
      scope: []
      test_levels: []
      test_techniques: []
      coverage_target: ''
      related_requirements:
        functional_requirements: []
        non_functional_requirements: []
        interface_requirements: []
        data_requirements: []
      priority: null  # enum: critical/high/medium/low
      metadata: *metadata

  # Test Environments - 测试环境
  ENV:
    yaml_key: 'test_environments'
    description: 'Test Environments - 测试环境'
    template:
      id: ''
      summary: ''
      purpose: ''
      infrastructure: []
      software_requirements: []
      access_control: ''
      data_source: ''
      availability: ''
      metadata: *metadata

# 实体类型输出顺序（必须严格遵循）
entity_output_order:
  - 'user_stories'
  - 'use_cases'
  - 'functional_requirements'
  - 'non_functional_requirements'
  - 'interface_requirements'
  - 'data_requirements'
  - 'assumptions'
  - 'dependencies'
  - 'constraints'
  - 'risk_analysis'
  - 'test_levels'
  - 'test_types'
  - 'test_environments'
  - 'test_cases'

# 枚举值定义
enums:
  status:
    - 'draft'
    - 'approved'
    - 'implemented'
    - 'verified'
    - 'deprecated'
  
  priority:
    - 'critical'
    - 'high'
    - 'medium'
    - 'low'
  
  nfr_category:
    - 'performance'
    - 'security'
    - 'reliability'
    - 'maintainability'
    - 'portability'
    - 'compatibility'
    - 'usability'
    - 'scalability'
    - 'availability'
    - 'compliance'
  
  interface_type:
    - 'api'
    - 'ui'
    - 'database'
    - 'file'
    - 'other'
  
  risk_level:
    - 'critical'
    - 'high'
    - 'medium'
    - 'low' 
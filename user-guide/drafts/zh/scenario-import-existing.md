# 导入现有文档

> **场景**：你有会议记录、PRD 或其他文档，想把它们转换成正式的 SRS
> **所需时间**：10-15 分钟

---

## 重要说明：支持的文件格式

**SRS Writer 只能读取 VSCode 原生支持的文件格式**（无需额外扩展）。

### ✅ 支持的格式（文本类）

SRS Writer 直接支持以下纯文本文件：

- **Markdown**：`.md`、`.markdown`
- **纯文本**：`.txt`
- **代码文件**：`.js`、`.ts`、`.py`、`.java`、`.yaml`、`.json` 等
- **HTML**：`.html`
- **XML**：`.xml`
- **CSV**：`.csv`
- **任何 VSCode 能在编辑器中打开的文本格式**

### ❌ 不支持的格式（二进制）

以下格式**无法**直接读取：

- **Microsoft Word**：`.doc`、`.docx`
- **PDF**：`.pdf`
- **Microsoft Excel**：`.xls`、`.xlsx`
- **PowerPoint**：`.ppt`、`.pptx`
- **图片**：`.png`、`.jpg`、`.gif`（除非你有能提取文字的 VSCode 扩展）

### 🔄 解决方案：将二进制文件转换为文本

如果你的文档是不支持的格式，必须先进行转换。

#### 推荐：Office to Markdown Converter（VSCode 扩展）

**转换 Office 文档最简单的方式**是使用 Testany 的 **Office to Markdown Converter** 扩展。

**功能特点**：
- 将 Word（`.docx`）、Excel（`.xlsx`、`.xls`）和 PowerPoint（`.pptx`）转换为简洁的 Markdown
- 在 VSCode 资源管理器中右键一键转换
- AI 驱动的图片处理：自动提取图片并生成替代文本
- 保留格式：表格、列表、标题、超链接
- 公式转换为 LaTeX 格式
- 批量处理：一次转换多个文件

**安装方法**：

1. 打开 VSCode 扩展视图（`Cmd+Shift+X` / `Ctrl+Shift+X`）
2. 搜索：`Office to Markdown Converter`
![Converter install](../images/zh/image-20251211-142601_0001.png)
3. 点击**安装**
4. 发布者：**Testany**

**应用商店**：https://marketplace.visualstudio.com/items?itemName=Testany.office-to-markdown

**使用方法**：

1. 将 Office 文件放入工作区
2. 在 VSCode 资源管理器中右键点击文件（`.docx`、`.xlsx` 或 `.pptx`）
3. 选择**"Convert to Markdown"**
4. 扩展会生成同名的 `.md` 文件
5. 现在你可以用 SRS Writer 处理这个 Markdown 文件了！

**示例**：
```
MyProject/
├── docs/
│   ├── requirements.docx           ← 原始 Word 文件
│   └── requirements.md             ← 转换后自动生成 ✅
```

**系统要求**：
- VSCode 1.102.0 或更高版本
- 安装 GitHub Copilot（用于 AI 驱动的图片描述）

---

#### 其他方法（手动）

如果你不想安装扩展，可以手动转换：

**Word/PDF → 文本**：
- 从 Word 导出：文件 → 另存为 → 纯文本（.txt）
- PDF：使用在线转换器（如 pdf2md.com）或复制粘贴文本内容
- Google 文档：文件 → 下载 → 纯文本（.txt）或 Markdown

**Excel → CSV**：
- Excel：文件 → 另存为 → CSV（.csv）
- 然后你可以将 CSV 内容粘贴到聊天中

**PowerPoint → 文本**：
- 将幻灯片内容复制到文本文件
- 或导出备注/大纲视图

**最佳实践**：使用 **Office to Markdown Converter** 扩展可获得最佳效果。它能保留格式、自动处理图片，生成的 Markdown 与 SRS Writer 无缝配合。

---

## 问题背景

你不是从零开始。你已经有：
- 利益相关者讨论的会议记录
- 产品简报或 PRD
- 用户研究发现
- Word/PDF 格式的现有文档
- 包含需求的邮件往来

**但是**：这些内容分散且不一致。

**你需要**：正式、标准化的 SRS 文档。

---

## 解决方案：让 SRS Writer 处理你的内容

SRS Writer 可以分析现有文档并提取结构化需求。

**重要**：请先确保文档是支持的文本格式（见上文）。

---

## 方法一：复制粘贴（最快）

### 适用场景

- 短文档（< 5 页）
- 文本容易获取
- 一次性快速导入

### 操作步骤

**第 1 步：复制内容**

从任何来源：
- Word 文档
- Google 文档
- Confluence 页面
- 邮件往来
- 笔记应用（Notion、Obsidian 等）

**第 2 步：打开 SRS Writer 聊天**

按 `Cmd+Shift+I` / `Ctrl+Shift+I`
![srs命令行](../images/zh/image-20251210-101516_0001.png)

**第 3 步：粘贴并附上说明**

```
@srs-writer 这是我们项目启动会的会议记录。
请根据这些内容生成正式的 SRS 文档。

[在此粘贴你的笔记]
```

**示例**：

```
@srs-writer 这是我们项目启动会的会议记录。
请根据这些内容生成正式的 SRS 文档。

---
会议：电商平台启动会
日期：2025-11-01
参会者：产品团队、工程团队、设计团队

目标：
- 为小型企业建立在线商店
- 简单的商品上架和管理
- 安全的支付处理
- 移动端友好

讨论的关键功能：
1. 卖家后台
   - 添加/编辑商品和图片
   - 库存跟踪
   - 销售分析

2. 客户体验
   - 按分类浏览商品
   - 带筛选的搜索
   - 购物车
   - Stripe 结账

3. 管理面板
   - 用户管理
   - 订单管理
   - 报表生成

技术约束：
- 必须支持 1000 并发用户
- 页面加载 < 2 秒
- 移动优先设计

安全性：
- 全站 HTTPS
- 支付 PCI DSS 合规
- 数据加密

时间表：3 个月 MVP
---
```

**第 4 步：审查和完善**

SRS Writer 会：
1. 提取关键需求
2. 组织成标准 SRS 结构
3. 补充缺失细节（标注假设）
4. 生成功能需求和非功能需求

**第 5 步：迭代**

审查生成的 SRS 后：

```
@srs-writer 很好的开始！补充几点：

1. 添加下单时邮件通知的需求
2. 卖家应该可以提供优惠码
3. 包含低库存（< 10 件）提醒功能
```

---

## 方法二：引用文件（适合大型文档）

### 适用场景

- 大型文档（> 5 页）
- 多个文件
- 文件在工作区内

### 操作步骤

**第 1 步：转换并放置文件到工作区**

**首先将二进制文件转换为文本格式**（见上文"支持的文件格式"部分）。

然后将文档放入 VSCode 可以访问的文件夹：
```
MyProject/
├── docs/
│   ├── meeting-notes-2025-11-01.md          ← Markdown（支持）
│   ├── product-brief.txt                    ← 从 PDF/Word 转换
│   └── user-research.md                     ← 从 Word 转换
```

**第 2 步：让 SRS Writer 读取文件**

```
@srs-writer 请读取以下文件并生成 SRS：
- docs/meeting-notes-2025-11-01.md
- docs/product-brief.txt
- docs/user-research.md

重点提取功能需求和用户需求。
```

> ⚠️ **重要**：SRS Writer 只能读取 VSCode 原生支持的纯文本文件。如果你有 `.pdf`、`.docx` 或其他二进制格式，**必须先转换为 `.txt` 或 `.md`**。
> ℹ️ 当选择了“基于现有草稿”流程时，`project_initializer` 会把引用的文件复制到项目目录并重命名为 `source_draft.md`，便于追踪来源。

**另一种方式 - 引用特定内容**：

```
@srs-writer 我在 docs/product-brief.md 中有一份产品简报。
关键部分包括：

- 目标受众：小型企业主
- 核心价值主张：1 小时内轻松建立在线商店
- 关键功能：[文档中的列表]

请将这些内容整合到正式的 SRS 中。
```

---

## 方法三：增量导入

### 适用场景

- 非常大或复杂的文档
- 多个来源有重叠信息
- 偏好分阶段方式

### 操作步骤

**第 1 步：从概述开始**

```
@srs-writer 创建一个新的 SRS 项目"电商平台"。

我会分阶段提供需求。先从这个概述开始：

目的：让小型企业能够在线销售
目标用户：500 个小型企业主
规模：1000 并发客户，每个卖家 5000 个商品
```

**第 2 步：添加功能需求**

```
@srs-writer 从这部分添加功能需求：

[粘贴卖家后台需求]
```

**第 3 步：添加非功能需求**

```
@srs-writer 添加非功能需求：

[粘贴性能、安全、可扩展性需求]
```

**第 4 步：添加 UI/UX 需求**

```
@srs-writer 根据我们的线框图添加 UI 需求：

[描述或粘贴线框图标注]
```

**优点**：你可以在每一步进行审查和控制。

---

## 更好导入效果的技巧

### 技巧 1：提供背景信息

**不好** ❌：
```
@srs-writer 根据这个生成 SRS：
[粘贴 20 页混合内容]
```

**好** ✅：
```
@srs-writer 这是 3 次利益相关者会议的会议记录。
讨论的是客户支持工单系统的需求。

背景：
- 当前系统：邮件（难以跟踪）
- 团队规模：10 名客服人员
- 客户群：500 家 B2B 公司

请提取需求，重点关注：
1. 工单管理工作流
2. 客服效率功能
3. 管理者报表

[粘贴笔记]
```

---

### 技巧 2：标明优先级

标记什么是关键：

```
@srs-writer 从这些笔记中，按以下优先级处理：

MVP 必须有：
- 用户认证
- 商品列表
- 购物车
- Stripe 支付

v2 可以有：
- 社交分享
- 收藏夹
- 商品评论
```

---

### 技巧 3：澄清歧义

如果笔记中有冲突信息：

```
@srs-writer 注意：会议记录中同时提到了"邮箱登录"和
"社交登录"。我们决定 MVP 先只做邮箱登录，
社交登录放到 v2。请在 SRS 中体现这一点。
```

---

### 技巧 4：说明目标受众

```
@srs-writer 这份 SRS 是给客户的提案，需要非常专业，
并包含合规性章节（GDPR、PCI DSS）和执行摘要。
```

或者：

```
@srs-writer 这是给开发团队的内部文档，
使用技术语言并包含 API 规格。
```

---

## 处理不同类型的文档

### 会议记录

**特点**：非正式、口语化、可能有待办事项

**最佳方式**：
```
@srs-writer 这是利益相关者讨论的会议记录。
包含决策、关注点和功能请求。
请提取正式需求，标注任何待确认问题。

[粘贴笔记]
```

SRS Writer 会：
- 将决策提取为需求
- 将关注点标记为风险或约束
- 识别待跟进的问题

---

### 产品需求文档（PRD）

**特点**：结构更完整，但常混合业务和技术内容

**最佳方式**：
```
@srs-writer 这份 PRD 描述了业务目标和高层功能。
请创建开发人员可以据此实现的技术 SRS。
重点关注功能规格和验收标准。

[粘贴 PRD]
```

---

### 用户研究/访谈记录

**特点**：用户故事、痛点、期望的工作流程

**最佳方式**：
```
@srs-writer 这是用户访谈记录，展示了当前系统的痛点
和期望的改进。

请将用户需求转换为正式需求，保持
对用户原话的可追溯性。

[粘贴记录]
```

---

### 邮件往来

**特点**：碎片化，决策混在讨论中

**最佳方式**：

1. 首先自己总结邮件：
   ```
   主题：支付处理需求

   已做决策：
   - 信用卡使用 Stripe
   - 支持 Apple Pay 和 Google Pay
   - 不存储卡号数据（PCI 合规）
   - 允许回头客保存支付方式

   待确认问题：
   - 支持国际货币？
   - 退款流程？
   ```

2. 然后请 SRS Writer：
   ```
   @srs-writer 根据这份邮件讨论摘要，
   创建支付处理需求。

   [粘贴你的摘要]
   ```

---

### 现有技术规格

**特点**：可能过于详细或已过时

**最佳方式**：
```
@srs-writer 我有一份 2020 年的旧技术规格。
请提取仍然相关的需求，更新术语
到当前标准。标记任何看起来过时的内容。

重点关注：
- 核心业务逻辑（仍然相关）
- 集成点
- 数据模型

忽略：
- 具体技术选择（已过时）
- 基础设施细节（将重新设计）

[粘贴规格]
```

---

## 常见问题及解决方案

### 问题 1：信息太多

**现象**：SRS Writer 生成的文档过长

**解决方案**：有选择地导入

```
@srs-writer 从这 50 页笔记中，只关注：
- MVP 核心功能
- 关键非功能需求（安全、性能）
- 必须的集成

跳过：
- 未来路线图项目
- 被否决的替代方案
- 背景研究
```

---

### 问题 2：缺少背景

**现象**：导入的内容缺乏上下文

**解决方案**：先添加背景

```
@srs-writer 在粘贴会议记录之前，先了解背景：

项目：客户支持门户
现状：使用邮件，工单丢失，没有指标
用户：10 名客服人员，500 个客户
目标：响应时间从 24 小时减少到 4 小时
预算：80,000 美元
时间：4 个月

现在是会议记录：
[粘贴笔记]
```

---

### 问题 3：信息冲突

**现象**：不同文档互相矛盾

**解决方案**：明确说明

```
@srs-writer 我有两份文档信息冲突：

文档 A（较旧）：说我们需要 iOS 和 Android 移动应用
文档 B（较新）：说我们先只做 Web，移动端以后再做

请以文档 B 为准。生成响应式 Web 应用的需求，
并将移动应用标注为未来增强。
```

---

### 问题 4：内容无结构

**现象**：笔记杂乱无章

**解决方案**：让 SRS Writer 整理

```
@srs-writer 这些笔记没有结构——功能、技术问题和
随机想法混在一起。请：

1. 提取清晰的需求
2. 分类为功能需求和非功能需求
3. 识别并归类相关需求
4. 将不清楚的标记为"待澄清"

[粘贴杂乱笔记]
```

---

## 导入后的质量检查

导入并生成后，一定要检查质量：

```
@srs-writer 对导入的需求运行质量检查
```

**导入内容的常见问题**：
- ⚠️ 清晰度低：非正式笔记的语言模糊
- ⚠️ 可测试性低：缺少验收标准
- ⚠️ 完整性低：需求有缺口

**迭代修复**：
```
@srs-writer 质量报告显示 FR-003、FR-007、FR-012 存在清晰度问题。
请使用可度量的标准让这些更具体。
```

---

## 实际示例：完整导入流程

让我们走一遍真实场景：

**起点**：项目启动会的会议记录

**第 1 步：初始导入**
```
@srs-writer 创建"费用报销系统"的 SRS

会议背景：
- 公司：200 名员工
- 现状：Excel 电子表格（容易出错，没有审计追踪）
- 用户：员工提交，财务审批，CFO 查看报表
- 规模：每月约 500 笔报销申请

讨论的关键功能：
- 移动应用提交费用并拍照上传收据
- 经理审批流程
- 与会计系统（QuickBooks）集成
- 给 CFO 的月度报表

需求：
- 员工必须能在 2 分钟内提交
- 经理 24 小时内审核
- 自动标记违规（如超限额）

生成核心流程的初始 SRS。
```

**第 2 步：审查生成的 SRS**

（SRS Writer 创建提交、审批、报表的功能需求）

**第 3 步：补充缺失细节**
```
@srs-writer 很好的开始。补充这些细节：

审批流程：
- 直属经理审批 < 500 美元
- 部门主管审批 500-5000 美元
- CFO 审批 > 5000 美元
- 合规范围内 < 50 美元自动审批

政策规则：
- 餐费：每天限额 50 美元
- 住宿：每晚限额 200 美元
- 里程：0.58 美元/英里（IRS 标准）
- 差旅补贴因城市而异（集成城市费率数据库）
```

**第 4 步：明确非功能需求**
```
@srs-writer 添加具体的非功能需求：

性能：
- 移动应用：2 分钟内提交费用
- Web 后台：1 秒内加载
- 报表生成：月度报表 < 5 秒

安全：
- 收据图片：加密存储，7 年后自动删除
- 审计日志：记录所有审批和变更
- 访问控制：基于角色（员工、经理、财务、管理员）
```

**第 5 步：最终质量检查**
```
@srs-writer 检查质量并修复任何问题
```

**结果**：15 分钟内创建了可供开发的专业 SRS。

---

## 下一步

**你已成功导入现有内容！**

**继续完善**：
👉 [更新需求](scenario-update-requirements)
👉 [提升质量](scenario-quality-improvement)

**了解更多**：
👉 [对话技巧](getting-started-conversation-tips)

---

**有问题？** [查看常见问题](faq-common-questions) 或 [社区讨论](https://github.com/Testany-io/srs-writer-plugin/discussions)

